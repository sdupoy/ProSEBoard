<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fr.eseo.ld.proseboard.mybatis.mappers.SessionMapper">
	
	<resultMap type="Session" id="SessionResult">
		<id property="id" column="id" />
		<result property="name" column="name" />
		<result property="nbTeam" column="nb_team" />
		<result property="startDate" column="start_date" />
		<result property="endDate" column="end_date" />
	</resultMap>
	
	<select id="getAllSession" resultMap="SessionResult">
		SELECT id, name FROM session
	</select>
	
	<select id="getAll" resultMap="SessionResult">
		SELECT * FROM session ORDER BY name
	</select>
	
	<select id="getAllSaufEnd" resultMap="SessionResult">
		SELECT session.id, session.name, session.nb_team, session.start_date FROM session ORDER BY name
	</select>
	
	<select id="getLastSession" resultMap="SessionResult">
		SELECT * FROM session ORDER BY start_date DESC LIMIT 1
	</select>
	
	<insert id="insertSession" parameterType="Session" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO session(name, nb_team, start_date, end_date)
		VALUES(#{name}, #{nbTeam}, #{startDate}, #{endDate})
	</insert>	
	
	<select id="getSessionById" resultMap="SessionResult" parameterType="long">
		SELECT * FROM session WHERE id = #{id}
	</select>
	
	<delete id="deleteSessionById" parameterType="long">
		DELETE FROM session WHERE id = #{id}
	</delete>
	
	<update id="incrementNbTeamById" parameterType="long">
		UPDATE session SET nb_team = nb_team + 1 WHERE id = #{id}
	</update>
	
	<update id="decrementNbTeamById" parameterType="long">
		UPDATE session SET nb_team = nb_team - 1 WHERE id = #{id}
	</update>
	
</mapper>
