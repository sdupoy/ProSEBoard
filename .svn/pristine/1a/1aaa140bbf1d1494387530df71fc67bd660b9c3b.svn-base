<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@taglib prefix="t" tagdir="/WEB-INF/tags"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<t:main>
<jsp:attribute name="manage_trainingReport">en</jsp:attribute>
	<jsp:body>
	<div class="row">
		<div class="col-md-12 col-lg-10">
			<h1>Rapports de formation</h1>
			<table class="table table-hover table-striped">
				<thead>
					<tr>
						<th>Formateur</th>
						<th>Sujet</th>
						<th>Date du consulting:</th>
						<th>Participants</th>
						<th>Rapport</th>
						<th>Facturation</th>
					</tr>
				</thead>
				<c:forEach items="${training}" var="training">
					<tr>
						<td>${training.getEducator().getFirstName()} ${training.getEducator().getLastName() } </td>
						<td>${training.getSubject() }</td>
						<td>Du ${training.getEventBis().getStartDate()} <br/>
							au ${training.getEvent().getEndDateString()}
						</td>
						<td>
							<c:forEach items="${training.getAttenders()}" var="attender">
								<c:if test="${attender.getId()!=user.getId() }">
									${attender.getFirstName()} ${attender.getLastName() }<br />
								</c:if>
							</c:forEach>
						</td>
						<td>
							<c:if test="${empty training.getReport()  and training.getIdEducator()==user.getId()}">
								<a href="${pageContext.request.contextPath}/CreateTrainingReport" class="sb-btn">
								<button class="btn btn-primary" type="submit"><i class="fa  fa-pencil fw"></i> Rédiger le rapport</button>
								</a>
							</c:if>
							<c:if test="${not empty training.getReport()}">${training.getReport() }</c:if>
							<c:if test="${empty training.getReport() and training.getIdEducator()!=user.getId()}">Rapport non rédigé</c:if>
						</td>
						<td>
							<c:if test="${not training.isCharged() and training.getIdEducator()==user.getId()}">
								<a href="${pageContext.request.contextPath}/chargeConsultingSession" class="sb-btn">
								<button class="btn btn-primary" type="submit"><i class="fa fa-euro fw"></i> Facturer</button>
								</a>
							</c:if>
							<c:if test="${training.isCharged()}">Facturation réalisée</c:if>
							<c:if test="${not training.isCharged() and training.getIdEducator()!=user.getId()}">Facturation non réalisée</c:if>
						</td>
					</tr>


				</c:forEach>
			</table>
		</div>
	</div>
	</jsp:body>
</t:main>